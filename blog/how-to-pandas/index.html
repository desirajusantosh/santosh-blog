<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><meta name=description content="Santosh Desiraju's web site"><title>How to - Pandas - Santosh Desiraju</title><meta property="og:title" content="How to - Pandas - Santosh Desiraju"><meta property="og:type" content="website"><meta property="og:description" content="Santosh Desiraju's web site"><meta property="og:url" content="https://desirajusantosh.github.io/santosh-blog/blog/how-to-pandas/"><meta property="og:site_name" content="Santosh Desiraju"><meta property="og:image" content="https://desirajusantosh.github.io/santosh-blog/home/profile.jpg"><meta property="og:image" content="https://desirajusantosh.github.io/santosh-blog/home/yosemite_lakes_park.jpeg"><link rel="shortcut icon" href=https://desirajusantosh.github.io/santosh-blog/img/fav.ico><link rel=stylesheet href=https://desirajusantosh.github.io/santosh-blog/css/main.min.5c5478bdd5363758f3e73657d5339b1ac7c131a401ffc3338edd7eb5e1a0114e.css integrity="sha256-XFR4vdU2N1jz5zZX1TObGsfBMaQB/8Mzjt1+teGgEU4=" crossorigin=anonymous media=screen></head><body><section id=top class=section><div class="container hero"><h1 class="bold-title is-1">Blog</h1></div><div class=section><div class=container><hr><nav class=navbar role=navigation aria-label="main navigation"><a role=button class=navbar-burger data-target=navMenu aria-label=menu aria-expanded=false><span aria-hidden=true></span><span aria-hidden=true></span><span aria-hidden=true></span></a><div class=navbar-menu id=navMenu><a class=navbar-item href=https://desirajusantosh.github.io/santosh-blog/>main</a>
<a class=navbar-item href=https://desirajusantosh.github.io/santosh-blog/#about>About</a>
<a class=navbar-item href=https://desirajusantosh.github.io/santosh-blog/projects/>Musing</a>
<a class=navbar-item href=https://desirajusantosh.github.io/santosh-blog/blog/>Back to Blog</a>
<a class=navbar-item href=https://desirajusantosh.github.io/santosh-blog/#contact>Contact</a></div></nav><hr></div><div class=container><h2 class="title is-1 top-pad strong-post-title"><a href=https://desirajusantosh.github.io/santosh-blog/blog/how-to-pandas/>How to - Pandas</a></h2><div class=post-data>Dec 19, 2022 |
2 minutes read</div><div class=blog-share>Share this:
<a class=twitter-share-button href="https://twitter.com/intent/tweet?text=How%20to%20-%20Pandas%20https%3a%2f%2fdesirajusantosh.github.io%2fsantosh-blog%2fblog%2fhow-to-pandas%2f" onclick="window.open(this.href,'twitter-share','width=550,height=235');return false;"><i class="fab fa-twitter"></i><span class=hidden>Twitter</span></a>
<a class=icon-facebook href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fdesirajusantosh.github.io%2fsantosh-blog%2fblog%2fhow-to-pandas%2f" onclick="window.open(this.href,'facebook-share','width=580,height=296');return false;"><i class="fab fa-facebook-f"></i><span class=hidden>Facebook</span></a>
<a class=icon-pinterest href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2fdesirajusantosh.github.io%2fsantosh-blog%2fblog%2fhow-to-pandas%2f&description=How%20to%20-%20Pandas" onclick="window.open(this.href,'pinterest-share','width=580,height=296');return false;"><i class="fab fa-pinterest-p"></i><span class=hidden>Pinterest</span></a></div><p>Tags:
<a href=https://desirajusantosh.github.io/santosh-blog/tags/blog>blog</a>,
<a href=https://desirajusantosh.github.io/santosh-blog/tags/howto>howto</a></p></div><div class="container markdown top-pad"><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>import</span> pandas <span style=color:#f92672>as</span> pd

<span style=color:#75715e># Displaying complete dataframe</span>
pd<span style=color:#f92672>.</span>set_option(<span style=color:#e6db74>&#34;display.max_rows&#34;</span>, None, <span style=color:#e6db74>&#34;display.max_columns&#34;</span>, None)
<span style=color:#75715e>#pd.set_option(&#39;display.max_colwidth&#39;, None)  </span>
pd<span style=color:#f92672>.</span>set_option(<span style=color:#e6db74>&#39;display.max_colwidth&#39;</span>, <span style=color:#ae81ff>199</span>)  
pd<span style=color:#f92672>.</span>set_option(<span style=color:#e6db74>&#39;display.height&#39;</span>,<span style=color:#ae81ff>1000</span>)
pd<span style=color:#f92672>.</span>set_option(<span style=color:#e6db74>&#39;display.max_rows&#39;</span>,<span style=color:#ae81ff>500</span>)
pd<span style=color:#f92672>.</span>set_option(<span style=color:#e6db74>&#39;display.max_columns&#39;</span>,<span style=color:#ae81ff>500</span>)
pd<span style=color:#f92672>.</span>set_option(<span style=color:#e6db74>&#39;display.width&#39;</span>,<span style=color:#ae81ff>1000</span>)
pd<span style=color:#f92672>.</span>set_option(<span style=color:#e6db74>&#39;display.max_columns&#39;</span>, None)  <span style=color:#75715e># or 1000</span>
pd<span style=color:#f92672>.</span>set_option(<span style=color:#e6db74>&#39;display.max_rows&#39;</span>, None)  <span style=color:#75715e># or 1000</span>
<span style=color:#75715e>#pd.set_option(&#39;display.max_colwidth&#39;, None)  # or 199</span>
pd<span style=color:#f92672>.</span>set_option(<span style=color:#e6db74>&#39;display.max_colwidth&#39;</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)


fh <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;/path/to/file.csv&#34;</span>

<span style=color:#75715e>## Reading csv file</span>
df <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_csv(fh)

df <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_csv(fh,header<span style=color:#f92672>=</span>None)

df <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_csv(fh,header<span style=color:#f92672>=</span>None,sep<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;\s+&#39;</span>,engine<span style=color:#f92672>=</span>python,index_col<span style=color:#f92672>=</span>False)

df <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_csv(fh,header<span style=color:#f92672>=</span>None,sep<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;\s+&#39;</span>,engine<span style=color:#f92672>=</span>python,index_col<span style=color:#f92672>=</span>False, names<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;name&#39;</span>,<span style=color:#e6db74>&#39;id&#39;</span>,<span style=color:#e6db74>&#39;start&#39;</span>,<span style=color:#e6db74>&#39;end&#39;</span>])


<span style=color:#75715e>## Working with index</span>
df<span style=color:#f92672>.</span>set_index(<span style=color:#e6db74>&#39;name&#39;</span>,inplace<span style=color:#f92672>=</span>True)
df<span style=color:#f92672>.</span>set_index(<span style=color:#e6db74>&#39;name&#39;</span>,drop<span style=color:#f92672>=</span>False)

df<span style=color:#f92672>.</span>reset_index()
df<span style=color:#f92672>.</span>reset_index(drop<span style=color:#f92672>=</span>True)
<span style=color:#75715e># Searching becomes easy with indexing</span>
df<span style=color:#f92672>.</span>loc[<span style=color:#ae81ff>50</span>]
df<span style=color:#f92672>.</span>loc[df[<span style=color:#e6db74>&#39;start&#39;</span>]<span style=color:#f92672>.</span>str<span style=color:#f92672>.</span>endswith(<span style=color:#e6db74>&#34;999&#34;</span>)]
df<span style=color:#f92672>.</span>loc[df[<span style=color:#e6db74>&#39;name&#39;</span>]<span style=color:#f92672>.</span>isin<span style=color:#f92672>.</span>([<span style=color:#e6db74>&#39;alex&#39;</span>,<span style=color:#e6db74>&#39;jim&#39;</span>])]

<span style=color:#75715e>## High level info and stats</span>
df<span style=color:#f92672>.</span>info()

<span style=color:#75715e>#rows and columsn</span>
df<span style=color:#f92672>.</span>shape

<span style=color:#75715e>#number of elements</span>
df<span style=color:#f92672>.</span>size

<span style=color:#75715e>#number of rows</span>
len(df)

<span style=color:#75715e>#include, exclude - object, float</span>
df<span style=color:#f92672>.</span>describe()

<span style=color:#75715e>## Working with NaN</span>

<span style=color:#75715e># Drop all rows with NaN value in a dataframe</span>
df<span style=color:#f92672>.</span>dropna()
df[df<span style=color:#f92672>.</span>notnull()<span style=color:#f92672>.</span>all(<span style=color:#ae81ff>1</span>)]

<span style=color:#75715e>#axis=0:row, axis=1:column, subset</span>
df<span style=color:#f92672>.</span>dropna(how<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;all&#39;</span>,axis<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>)
df<span style=color:#f92672>.</span>dropna(subset<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#34;name&#34;</span>,<span style=color:#e6db74>&#34;id&#34;</span>])

<span style=color:#75715e>#Dropping NaN rows specific column</span>
df[df[<span style=color:#e6db74>&#39;start&#39;</span>]<span style=color:#f92672>.</span>notna()]

<span style=color:#75715e>#Dropping columns</span>
df <span style=color:#f92672>=</span> df<span style=color:#f92672>.</span>drop(<span style=color:#e6db74>&#39;id&#39;</span>)
<span style=color:#75715e>#or</span>
df<span style=color:#f92672>.</span>drop(<span style=color:#e6db74>&#39;id&#39;</span>,inplace<span style=color:#f92672>=</span>True)

<span style=color:#75715e>## Combining dataframes</span>
<span style=color:#75715e># Default value of ignore_index is False</span>
df3 <span style=color:#f92672>=</span> df1<span style=color:#f92672>.</span>append(df2,ignore_index<span style=color:#f92672>=</span>True)

<span style=color:#75715e># Inserting column</span>
df <span style=color:#f92672>=</span> df<span style=color:#f92672>.</span>assign(new_col_name<span style=color:#f92672>=</span>[<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>7</span>,<span style=color:#ae81ff>4</span>])
df <span style=color:#f92672>=</span> df<span style=color:#f92672>.</span>insert(<span style=color:#ae81ff>3</span>,<span style=color:#e6db74>&#39;new_col_name&#39;</span>,[<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>7</span>,<span style=color:#ae81ff>4</span>])

<span style=color:#75715e># Lambda </span>
<span style=color:#75715e>#lambda x: x.points / 2</span>

<span style=color:#75715e>## Renaming column</span>
df<span style=color:#f92672>.</span>rename({<span style=color:#e6db74>&#39;name&#39;</span>:<span style=color:#e6db74>&#39;NAME&#39;</span>})
df<span style=color:#f92672>.</span>rename(columns <span style=color:#f92672>=</span> str<span style=color:#f92672>.</span>upper)

df<span style=color:#f92672>.</span>columns <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;NAME&#39;</span>,<span style=color:#e6db74>&#39;START&#39;</span>]

<span style=color:#75715e>## String operations</span>
regex <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;J.*&#39;</span>
df[df<span style=color:#f92672>.</span>name<span style=color:#f92672>.</span>str<span style=color:#f92672>.</span>match(regex)]

<span style=color:#75715e>## Comprehensions for performing multiple string operations</span>

<span style=color:#75715e>## Accessing</span>
<span style=color:#75715e>#Accessing entire row - returns series</span>
df<span style=color:#f92672>.</span>iloc[<span style=color:#ae81ff>0</span>]
<span style=color:#75715e>#Accessing value </span>
df<span style=color:#f92672>.</span>iat[<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>1</span>]
<span style=color:#75715e>#Accessing value by converting to numpy array</span>

df[<span style=color:#e6db74>&#39;name&#39;</span>]<span style=color:#f92672>.</span>tolist()
df[<span style=color:#e6db74>&#39;name&#39;</span>]<span style=color:#f92672>.</span>values<span style=color:#f92672>.</span>tolist()
list(df[<span style=color:#e6db74>&#39;name&#39;</span>])

<span style=color:#75715e>## Adding to a dataframe</span>
<span style=color:#75715e># Append a list</span>
df <span style=color:#f92672>=</span> df<span style=color:#f92672>.</span>append([list1])

<span style=color:#75715e># Concat 2 dataframes</span>
df_new <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>concat([df1,df2])

<span style=color:#75715e>## Groupby</span>
<span style=color:#75715e>#Printing grouped df</span>
df<span style=color:#f92672>.</span>groupby(<span style=color:#e6db74>&#39;A&#39;</span>)<span style=color:#f92672>.</span>apply(<span style=color:#66d9ef>print</span>)
df<span style=color:#f92672>.</span>groupby(by)<span style=color:#f92672>.</span>apply(<span style=color:#66d9ef>lambda</span> a: a[:])
df<span style=color:#f92672>.</span>groupby(by)<span style=color:#f92672>.</span>apply(<span style=color:#66d9ef>lambda</span> a: a<span style=color:#f92672>.</span>drop(by, axis<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>)[:])


(df<span style=color:#f92672>.</span>groupby(<span style=color:#e6db74>&#34;Groups&#34;</span>, as_index<span style=color:#f92672>=</span>False)
           <span style=color:#f92672>.</span>agg({<span style=color:#e6db74>&#34;Date&#34;</span>:<span style=color:#e6db74>&#34;first&#34;</span>, <span style=color:#e6db74>&#34;data1&#34;</span>:<span style=color:#e6db74>&#34;sum&#34;</span>, <span style=color:#e6db74>&#34;data2&#34;</span>:<span style=color:#e6db74>&#34;sum&#34;</span>}))
Out[<span style=color:#ae81ff>5</span>]:

Reference:
https:<span style=color:#f92672>//</span>sparkbyexamples<span style=color:#f92672>.</span>com<span style=color:#f92672>/</span>pandas<span style=color:#f92672>/</span>pandas<span style=color:#f92672>-</span>groupby<span style=color:#f92672>-</span>sum<span style=color:#f92672>-</span>examples<span style=color:#f92672>/</span>
https:<span style=color:#f92672>//</span>realpython<span style=color:#f92672>.</span>com<span style=color:#f92672>/</span>pandas<span style=color:#f92672>-</span>groupby<span style=color:#f92672>/</span>

</code></pre></div></div><div class=container><hr></div><div class="container has-text-centered top-pad"><a href=#top><i class="fa fa-arrow-up"></i></a></div><div class=container><hr></div><div class=section id=footer><div class="container has-text-centered"><span class=footer-text><a href=https://github.com/victoriadrake/hugo-theme-introduction/><strong>Introduction</strong></a> theme for <a href=http://gohugo.io/>Hugo</a>. Made with and by open source contributors. <a href=https://www.netlify.com/>Netlify</a> builds and hosts this site.</span></div></div></div></section><script src=https://desirajusantosh.github.io/santosh-blog/js/bundle.e6934e69d06bb8a213134f4c1468f9478bb7755e786dfb60e3c5a917c5335805.js integrity="sha256-5pNOadBruKITE09MFGj5R4u3dV54bftg48WpF8UzWAU="></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','G-152PCJSKRY','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></body></html>